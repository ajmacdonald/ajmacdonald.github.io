(this.webpackJsonpspotifytagger=this.webpackJsonpspotifytagger||[]).push([[0],{238:function(e,t){},255:function(e,t){},265:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),s=n.n(c),i=n(10),o=n(341),l=n(78),u=n(156),b=n(337),d=n(339),h=n(340),f=n(335),j=n(326),p=n(83),g=n(135),m=n(342),L=n(334),x=n(349),O=n(86),y=n(17),v=n(112),k=n(183),w=n(4),C=["tagColor","barColor"],T=function(e){var t=e.tagColor,n=void 0===t?"#1de9b6":t,a=e.barColor,r=void 0===a?"#303030":a,c=Object(v.a)(e,C);return Object(w.jsxs)(k.a,Object(y.a)(Object(y.a)({},c),{},{viewBox:"0 0 400 400",children:[Object(w.jsx)("path",{stroke:"null",fill:n,d:"m310.75011,69.83626c-7.60697,-10.77654 -20.28526,-17.7496 -34.44268,-17.7496l-232.43525,0.21131c-23.24352,0 -42.26096,18.80613 -42.26096,42.04965l0,211.30478c0,23.24352 19.01743,42.04965 42.26096,42.04965l232.43525,0.21131c14.15742,0 26.83571,-6.97306 34.44268,-17.7496l83.67669,-117.90806c5.28262,-7.39567 5.28262,-17.11569 0,-24.51136l-83.67669,-117.90806l0,-0.00001z"}),Object(w.jsx)("path",{stroke:"null",fill:r,d:"M266.54 244.56L267.29 244.64L268.04 244.75L268.78 244.88L269.51 245.04L270.22 245.24L270.93 245.46L271.62 245.7L272.3 245.97L272.96 246.27L273.62 246.59L274.25 246.94L274.88 247.31L275.48 247.7L276.07 248.12L276.65 248.55L277.2 249.01L277.74 249.49L278.26 249.99L278.76 250.51L279.24 251.05L279.7 251.6L280.13 252.18L280.55 252.77L280.94 253.37L281.31 254L281.66 254.63L281.98 255.29L282.28 255.95L282.55 256.63L282.79 257.32L283.01 258.03L283.21 258.74L283.37 259.47L283.5 260.21L283.61 260.96L283.69 261.71L283.73 262.48L283.75 263.25L283.73 264.02L283.69 264.79L283.61 265.54L283.5 266.29L283.37 267.03L283.21 267.76L283.01 268.47L282.79 269.18L282.55 269.87L282.28 270.55L281.98 271.21L281.66 271.87L281.31 272.5L280.94 273.13L280.55 273.73L280.13 274.32L279.7 274.9L279.24 275.45L278.76 275.99L278.26 276.51L277.74 277.01L277.2 277.49L276.65 277.95L276.07 278.38L275.48 278.8L274.88 279.19L274.25 279.56L273.62 279.91L272.96 280.23L272.3 280.53L271.62 280.8L270.93 281.04L270.22 281.26L269.51 281.46L268.78 281.62L268.04 281.75L267.29 281.86L266.54 281.94L265.77 281.98L265 282L77.5 282L76.73 281.98L75.96 281.94L75.21 281.86L74.46 281.75L73.72 281.62L72.99 281.46L72.28 281.26L71.57 281.04L70.88 280.8L70.2 280.53L69.54 280.23L68.88 279.91L68.25 279.56L67.62 279.19L67.02 278.8L66.43 278.38L65.85 277.95L65.3 277.49L64.76 277.01L64.24 276.51L63.74 275.99L63.26 275.45L62.8 274.9L62.37 274.32L61.95 273.73L61.56 273.13L61.19 272.5L60.84 271.87L60.52 271.21L60.22 270.55L59.95 269.87L59.71 269.18L59.49 268.47L59.29 267.76L59.13 267.03L59 266.29L58.89 265.54L58.81 264.79L58.77 264.02L58.75 263.25L58.77 262.48L58.81 261.71L58.89 260.96L59 260.21L59.13 259.47L59.29 258.74L59.49 258.03L59.71 257.32L59.95 256.63L60.22 255.95L60.52 255.29L60.84 254.63L61.19 254L61.56 253.37L61.95 252.77L62.37 252.18L62.8 251.6L63.26 251.05L63.74 250.51L64.24 249.99L64.76 249.49L65.3 249.01L65.85 248.55L66.43 248.12L67.02 247.7L67.62 247.31L68.25 246.94L68.88 246.59L69.54 246.27L70.2 245.97L70.88 245.7L71.57 245.46L72.28 245.24L72.99 245.04L73.72 244.88L74.46 244.75L75.21 244.64L75.96 244.56L76.73 244.52L77.5 244.5L265 244.5L265.77 244.52L266.54 244.56ZM304.04 182.31L304.79 182.39L305.54 182.5L306.28 182.63L307.01 182.79L307.72 182.99L308.43 183.21L309.12 183.45L309.8 183.72L310.46 184.02L311.12 184.34L311.75 184.69L312.38 185.06L312.98 185.45L313.57 185.87L314.15 186.3L314.7 186.76L315.24 187.24L315.76 187.74L316.26 188.26L316.74 188.8L317.2 189.35L317.63 189.93L318.05 190.52L318.44 191.12L318.81 191.75L319.16 192.38L319.48 193.04L319.78 193.7L320.05 194.38L320.29 195.07L320.51 195.78L320.71 196.49L320.87 197.22L321 197.96L321.11 198.71L321.19 199.46L321.23 200.23L321.25 201L321.23 201.77L321.19 202.54L321.11 203.29L321 204.04L320.87 204.78L320.71 205.51L320.51 206.22L320.29 206.93L320.05 207.62L319.78 208.3L319.48 208.96L319.16 209.62L318.81 210.25L318.44 210.88L318.05 211.48L317.63 212.07L317.2 212.65L316.74 213.2L316.26 213.74L315.76 214.26L315.24 214.76L314.7 215.24L314.15 215.7L313.57 216.13L312.98 216.55L312.38 216.94L311.75 217.31L311.12 217.66L310.46 217.98L309.8 218.28L309.12 218.55L308.43 218.79L307.72 219.01L307.01 219.21L306.28 219.37L305.54 219.5L304.79 219.61L304.04 219.69L303.27 219.73L302.5 219.75L77.5 219.75L76.73 219.73L75.96 219.69L75.21 219.61L74.46 219.5L73.72 219.37L72.99 219.21L72.28 219.01L71.57 218.79L70.88 218.55L70.2 218.28L69.54 217.98L68.88 217.66L68.25 217.31L67.62 216.94L67.02 216.55L66.43 216.13L65.85 215.7L65.3 215.24L64.76 214.76L64.24 214.26L63.74 213.74L63.26 213.2L62.8 212.65L62.37 212.07L61.95 211.48L61.56 210.88L61.19 210.25L60.84 209.62L60.52 208.96L60.22 208.3L59.95 207.62L59.71 206.93L59.49 206.22L59.29 205.51L59.13 204.78L59 204.04L58.89 203.29L58.81 202.54L58.77 201.77L58.75 201L58.77 200.23L58.81 199.46L58.89 198.71L59 197.96L59.13 197.22L59.29 196.49L59.49 195.78L59.71 195.07L59.95 194.38L60.22 193.7L60.52 193.04L60.84 192.38L61.19 191.75L61.56 191.12L61.95 190.52L62.37 189.93L62.8 189.35L63.26 188.8L63.74 188.26L64.24 187.74L64.76 187.24L65.3 186.76L65.85 186.3L66.43 185.87L67.02 185.45L67.62 185.06L68.25 184.69L68.88 184.34L69.54 184.02L70.2 183.72L70.88 183.45L71.57 183.21L72.28 182.99L72.99 182.79L73.72 182.63L74.46 182.5L75.21 182.39L75.96 182.31L76.73 182.27L77.5 182.25L302.5 182.25L303.27 182.27L304.04 182.31ZM266.54 119.06L267.29 119.14L268.04 119.25L268.78 119.38L269.51 119.54L270.22 119.74L270.93 119.96L271.62 120.2L272.3 120.47L272.96 120.77L273.62 121.09L274.25 121.44L274.88 121.81L275.48 122.2L276.07 122.62L276.65 123.05L277.2 123.51L277.74 123.99L278.26 124.49L278.76 125.01L279.24 125.55L279.7 126.1L280.13 126.68L280.55 127.27L280.94 127.87L281.31 128.5L281.66 129.13L281.98 129.79L282.28 130.45L282.55 131.13L282.79 131.82L283.01 132.53L283.21 133.24L283.37 133.97L283.5 134.71L283.61 135.46L283.69 136.21L283.73 136.98L283.75 137.75L283.73 138.52L283.69 139.29L283.61 140.04L283.5 140.79L283.37 141.53L283.21 142.26L283.01 142.97L282.79 143.68L282.55 144.37L282.28 145.05L281.98 145.71L281.66 146.37L281.31 147L280.94 147.63L280.55 148.23L280.13 148.82L279.7 149.4L279.24 149.95L278.76 150.49L278.26 151.01L277.74 151.51L277.2 151.99L276.65 152.45L276.07 152.88L275.48 153.3L274.88 153.69L274.25 154.06L273.62 154.41L272.96 154.73L272.3 155.03L271.62 155.3L270.93 155.54L270.22 155.76L269.51 155.96L268.78 156.12L268.04 156.25L267.29 156.36L266.54 156.44L265.77 156.48L265 156.5L77.5 156.5L76.73 156.48L75.96 156.44L75.21 156.36L74.46 156.25L73.72 156.12L72.99 155.96L72.28 155.76L71.57 155.54L70.88 155.3L70.2 155.03L69.54 154.73L68.88 154.41L68.25 154.06L67.62 153.69L67.02 153.3L66.43 152.88L65.85 152.45L65.3 151.99L64.76 151.51L64.24 151.01L63.74 150.49L63.26 149.95L62.8 149.4L62.37 148.82L61.95 148.23L61.56 147.63L61.19 147L60.84 146.37L60.52 145.71L60.22 145.05L59.95 144.37L59.71 143.68L59.49 142.97L59.29 142.26L59.13 141.53L59 140.79L58.89 140.04L58.81 139.29L58.77 138.52L58.75 137.75L58.77 136.98L58.81 136.21L58.89 135.46L59 134.71L59.13 133.97L59.29 133.24L59.49 132.53L59.71 131.82L59.95 131.13L60.22 130.45L60.52 129.79L60.84 129.13L61.19 128.5L61.56 127.87L61.95 127.27L62.37 126.68L62.8 126.1L63.26 125.55L63.74 125.01L64.24 124.49L64.76 123.99L65.3 123.51L65.85 123.05L66.43 122.62L67.02 122.2L67.62 121.81L68.25 121.44L68.88 121.09L69.54 120.77L70.2 120.47L70.88 120.2L71.57 119.96L72.28 119.74L72.99 119.54L73.72 119.38L74.46 119.25L75.21 119.14L75.96 119.06L76.73 119.02L77.5 119L265 119L265.77 119.02L266.54 119.06Z"})]}))},A=n(111),S=n.n(A),M=n(15),P=n.n(M),D=n(25),N=n(267),B=n(268),F=n(322),z=n(343),R=n(321),_=n(76),E=n(345),I=n(20),W={allTags:[],currentTags:[],myAlbumsCache:{lastCached:void 0,albums:[]},albumsForCurrentTags:[],currentAlbum:void 0,currentSearch:{query:void 0,tags:[]},playingAlbum:void 0,isPlaying:!1},U=r.a.createContext([{},function(){}]),q=function(e){var t=Object(a.useState)(W),n=Object(i.a)(t,2),r=n[0],c=n[1];return Object(w.jsx)(U.Provider,{value:[r,c],children:e.children})},G=n(320),K=n(40),J=n(41),V=n(162),H=n.n(V),X=n(113),Z=n(182),Y=n(163),$=n.n(Y);X.a.plugin(Z.a),X.a.plugin($.a);var Q=!1,ee=function(){function e(){Object(K.a)(this,e)}return Object(J.a)(e,null,[{key:"hasSpotifyToken",value:function(){return void 0!==e.spotifyApi.getAccessToken()}},{key:"setSpotifyToken",value:function(t){e.spotifyApi.setAccessToken(t)}},{key:"setDbName",value:function(t){e.pouchDB=new X.a(t)}},{key:"fetchSavedAlbums",value:function(t,n){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise(function(){var r=Object(D.a)(P.a.mark((function r(c,s){var i,o,l,u,b;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.spotifyApi.getMySavedAlbums({limit:n,offset:t});case 3:if(i=r.sent,o=i.body.total,l=i.body.items.map((function(t,n){return e._formatSpotifyAlbum(t.album)})),!a){r.next=12;break}return u=l.map((function(e){return e.id})),r.next=10,e.fetchTagsForAlbumKeys(u);case 10:b=r.sent,l.forEach((function(e){e.tags=b[e.id]||[]}));case 12:c([l,o]),r.next=19;break;case 15:r.prev=15,r.t0=r.catch(0),console.warn("fetchSavedAlbums",r.t0),c([[],0]);case 19:case 20:case"end":return r.stop()}}),r,null,[[0,15]])})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"fetchAlbumsByKey",value:function(t){return new Promise(function(){var n=Object(D.a)(P.a.mark((function n(a,r){var c,s,i;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=21;break}c=[];case 2:if(!(t.length>0)){n.next=18;break}return s=t.splice(0,20),n.prev=4,n.next=7,e.spotifyApi.getAlbums(s);case 7:i=n.sent,c=c.concat(i.body.albums.map((function(t,n){return e._formatSpotifyAlbum(t)}))),n.next=16;break;case 11:return n.prev=11,n.t0=n.catch(4),console.warn("fetchAlbumsByKey",n.t0),a([]),n.abrupt("break",18);case 16:n.next=2;break;case 18:a(c),n.next=23;break;case 21:console.warn("fetchAlbumsByKey: no keys!"),a([]);case 23:case"end":return n.stop()}}),n,null,[[4,11]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"fetchTracksForAlbum",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(function(){var a=Object(D.a)(P.a.mark((function a(r,c){var s,i;return P.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.spotifyApi.getAlbumTracks(t);case 3:if(s=a.sent,i=s.body.items,!n){a.next=10;break}return a.next=8,e.spotifyApi.getTracks(i.map((function(e){return e.id})));case 8:a.sent.body.tracks.forEach((function(e){i.find((function(t){return t.id===e.id})).popularity=e.popularity}));case 10:r(i),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(0),c(a.t0);case 16:case 17:case"end":return a.stop()}}),a,null,[[0,13]])})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"createPlaylist",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r,c){e.spotifyApi.createPlaylist(t,{description:n,public:a}).then((function(e){r(e.body.id)}),(function(e){c(e)}))}))}},{key:"addTracksToPlaylist",value:function(t,n){return new Promise(function(){var a=Object(D.a)(P.a.mark((function a(r,c){var s,i;return P.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:s="";case 1:if(!(n.length>0)){a.next=16;break}return i=n.splice(0,100),a.prev=3,a.next=6,e.spotifyApi.addTracksToPlaylist(t,i);case 6:s=a.sent,console.log(s),a.next=14;break;case 10:a.prev=10,a.t0=a.catch(3),console.warn("addTracksToPlaylist",a.t0),c(a.t0);case 14:a.next=1;break;case 16:r(s);case 17:case"end":return a.stop()}}),a,null,[[3,10]])})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"_formatSpotifyAlbum",value:function(e){return{id:e.id,albumArtists:e.artists.map((function(e){return e.name})).join(", "),albumName:e.name,albumArt:e.images[2].url,year:e.release_date.split("-")[0],tags:[]}}},{key:"fetchTagsForAlbumKeys",value:function(t){return new Promise((function(n,a){e.pouchDB.allDocs({keys:t,include_docs:!0}).then((function(e){var t={};e.rows.filter((function(e){return!e.error})).forEach((function(e){e.doc?t[e.id]=e.doc.tags:console.warn("no doc for",e)})),n(t)}),(function(e){console.warn("fetchTagsForAlbumKeys",e),n({})}))}))}},{key:"fetchDocsForTags",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(a,r){var c={};c=n?{tags:{$all:t}}:{tags:{$in:t}},e.pouchDB.find({selector:c,fields:["_id","tags"]}).then((function(e){a(e.docs)}),(function(e){console.warn("fetchDocsForTags",e),a([])}))}))}},{key:"fetchAlbumsForTags",value:function(t){return new Promise(function(){var n=Object(D.a)(P.a.mark((function n(a,r){var c,s,i;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.fetchDocsForTags(t);case 3:return c=n.sent,s=c.map((function(e){return e._id})),n.next=7,e.fetchAlbumsByKey(s);case 7:(i=n.sent).forEach((function(e){var t=c.find((function(t){return t._id===e.id}));t&&(e.tags=t.tags)})),a(i),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),console.warn("fetchAlbumsForTags",n.t0),a([]);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"fetchUniqueTags",value:function(){return new Promise((function(t,n){e.pouchDB.allDocs({include_docs:!0}).then((function(n){var a={};n.rows.forEach((function(t){t.doc.tags&&Array.isArray(t.doc.tags)?t.doc.tags.forEach((function(e){void 0===a[e]&&(a[e]=0),a[e]++})):(console.warn("doc is messed up so delete it",t),e.pouchDB.remove(t.doc))})),t(a)}),(function(e){console.warn("fetchUniqueTags",e),t({})}))}))}},{key:"fetchUniqueTagsArray",value:function(){return new Promise((function(t,n){e.fetchUniqueTags().then((function(e){for(var n=[],a=0,r=Object.entries(e);a<r.length;a++){var c=Object(i.a)(r[a],2),s=c[0],o=c[1];n.push({label:s,count:o})}t(n)}),(function(e){console.warn("fetchUniqueTagsArray",e),t([])}))}))}},{key:"updateDoc",value:function(t){return new Promise(function(){var n=Object(D.a)(P.a.mark((function n(a,r){var c;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.pouchDB.upsert(t.id,(function(e){return e.tags=t.tags,e}));case 3:c=n.sent,a(c),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),console.warn("upsertDoc",err),a(!1);case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"startDiscogsLog",value:function(){this.discogsStats.startTime=(new Date).getTime(),this.discogsStats.callTimes=[]}},{key:"getDiscogsMatchesForAlbum",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n?2:5;return new Promise(function(){var r=Object(D.a)(P.a.mark((function r(c,s){var i,o,l,u,b,d,h,f;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:Q,i=t.albumArtists.split(",")[0],o=!1,0===i.toLowerCase().indexOf("various")&&(o=!0,i=""),l=t.albumName.replace(/LP/,"").replace(/EP/,""),u=[{release_title:l,artist:i,per_page:1},{query:"".concat(l," ").concat(i),per_page:5},{query:"".concat(l),per_page:5},{query:"".concat(l.split(/\b/)[0]," ").concat(i),per_page:5},{query:"".concat(l.split(/\b/)[0]," ").concat(i.split(/\b/)[0]),per_page:5}],b=u.shift(),d=0,h=[],f=void 0;case 10:return d++,r.prev=11,r.next=14,e._doDiscogsSearch(b,n);case 14:h=r.sent,r.next=22;break;case 17:r.prev=17,r.t0=r.catch(11),console.warn("Probably exceeding API limit!!!",r.t0),h=[],f=r.t0;case 22:b=u.shift();case 23:if(!f&&d<a&&0===h.length&&b){r.next=10;break}case 24:f?s(f):(h=e._filterDiscogsResults(t,h,o),c(h));case 25:case"end":return r.stop()}}),r,null,[[11,17]])})));return function(e,t){return r.apply(this,arguments)}}())}},{key:"_doDiscogsSearch",value:function(e,t){var n=this;return new Promise((function(a,r){void 0!==n.discogsStats.callTimes&&n.discogsStats.callTimes.push((new Date).getTime());var c=new URL("https://api.discogs.com/database/search"),s=Object.assign(e,{type:"release",page:0,token:"zVXJkuBoXwLyxIzfZUwoxxjMIYzCiTkUYqlsQnjR"});c.search=new URLSearchParams(s).toString();fetch(c,{method:"GET",mode:"cors",headers:{}}).then(function(){var e=Object(D.a)(P.a.mark((function e(n){var r,c,s;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?950:0,e.next=3,n.json();case 3:c=e.sent,s=c.results.map((function(e){var t=e.title.indexOf(" - "),n=e.title.substr(0,t),a=e.title.substr(t+3);n=(n=n.replace(/\s\(\d+\)/g,"")).replace("*","");var r=[];return e.genre&&(r=r.concat(e.genre)),e.style&&(r=r.concat(e.style)),r=r.filter((function(e,t,n){return n.indexOf(e)===t})),{uri:e.uri,title:a,artists:n,genres:r,thumb:e.thumb}})),setTimeout((function(){a(s)}),r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){r(e)}))}))}},{key:"_filterDiscogsResults",value:function(e,t,n){var a=e.albumArtists.split(",").map((function(e){return e.split(/\s/)})).flat().map((function(e){return e.toLowerCase()})),r=e.albumName.split(/\s/).map((function(e){return e.replace(/\W/g,"").toLowerCase()})),c=n?0:1,s=Math.min(3,Math.ceil(r.length/2));return t.filter((function(e){var t=!0;c>0&&(t=e.artists.split(/(?:,\s)|(?:\s&\s)/).map((function(e){return e.split(/\s/)})).flat().map((function(e){return e.toLowerCase()})).filter((function(e){return-1!==a.indexOf(e)})).length>=c);var n=e.title.split(/\s/).map((function(e){return e.replace(/\W/g,"").toLowerCase()})).filter((function(e){return-1!==r.indexOf(e)}));return t&&n.length>=s}))}},{key:"titleCaseTags",value:function(){return new Promise(function(){var t=Object(D.a)(P.a.mark((function t(n,a){var r,c,s,i;return P.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.fetchUniqueTags();case 3:return r=t.sent,Object.keys(r).forEach((function(t){var n=e.toTitleCase(t);r[t]=n})),t.next=7,e.pouchDB.allDocs({include_docs:!0});case 7:return c=t.sent,s=[],c.rows.forEach((function(e){var t=e.doc.tags.map((function(e){return r[e]}));s.push({_id:e.doc._id,_rev:e.doc._rev,tags:t})})),t.next=12,e.pouchDB.bulkDocs(s);case 12:i=t.sent,n(i),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),console.warn("titleCaseTags",t.t0),n(!1);case 20:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"toTitleCase",value:function(e){return e.replace(/([^\W_]+[^\s-]*) */g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}}]),e}();ee.spotifyApi=new H.a,ee.pouchDB=void 0,ee.logDiscogsStats=!1,ee.discogsStats={startTime:void 0,callTimes:void 0};var te=ee,ne="MyAlbumsCache",ae=function(){var e=Object(a.useContext)(U),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(G.a)("(min-width:800px)");function s(e,t){return!1===o()?new Promise((function(a,r){var c=Object(I.a)(n.myAlbumsCache.albums),s=c.length;if(void 0!==e){var i=Math.min(s,e+t);c=c.slice(e,i)}a([c,s])})):te.fetchSavedAlbums(e,t,!0)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36e5;if(n.myAlbumsCache.lastCached){var t=(new Date).getTime();return t-n.myAlbumsCache.lastCached>e}return!0}function l(){return u.apply(this,arguments)}function u(){return(u=Object(D.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.fetchUniqueTagsArray();case 2:(t=e.sent).sort((function(e,t){return t.count-e.count})),r((function(e){return Object(y.a)(Object(y.a)({},e),{},{allTags:t})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return d.apply(this,arguments)}function d(){return(d=Object(D.a)(P.a.mark((function e(t){var a,c,s;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],!1!==o()){e.next=9;break}return e.next=4,te.fetchDocsForTags(t);case 4:c=e.sent,s=c.map((function(e){return e._id})),a=n.myAlbumsCache.albums.filter((function(e){return-1!==s.indexOf(e.id)})),e.next=12;break;case 9:return e.next=11,te.fetchAlbumsForTags(t);case 11:a=e.sent;case 12:r((function(e){return Object(y.a)(Object(y.a)({},e),{},{currentTags:t,albumsForCurrentTags:a})}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){-1===n.currentTags.indexOf(e)&&b([].concat(Object(I.a)(n.currentTags),[e]))}function f(e){b(n.currentTags.filter((function(t){return t!==e})))}return{setSpotifyToken:function(e){te.setSpotifyToken(e)},hasSpotifyToken:function(){return te.hasSpotifyToken()},setDatabaseName:function(e){te.setDbName(e),l()},persistentSideBar:function(){return c},sideBarWidth:function(){return 250},getMyAlbums:s,needsMyAlbumsCache:o,getMyAlbumsCache:function(){var e=JSON.parse(window.localStorage.getItem(ne));return null!==e&&console.log("got albums from localStorage"),e},setMyAlbumsCache:function(e){var t=(new Date).getTime();r((function(n){return Object(y.a)(Object(y.a)({},n),{},{myAlbumsCache:{albums:e,lastCached:t}})})),window.localStorage.setItem(ne,JSON.stringify(e))},getAlbumsForCurrentTags:function(e,t){return new Promise(function(){var a=Object(D.a)(P.a.mark((function a(r,c){var o,l,u,b,d;return P.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=0,!(n.currentTags.length>0)){a.next=6;break}l=n.albumsForCurrentTags.length,o=Object(I.a)(n.albumsForCurrentTags),a.next=12;break;case 6:return a.next=8,s(e,t);case 8:u=a.sent,b=Object(i.a)(u,2),o=b[0],l=b[1];case 12:void 0!==e&&(d=Math.min(l,e+t),o=o.slice(e,d)),r([o,l]);case 14:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},setTagsForAlbum:function(e,t){if(window.localStorage.removeItem(ne),!1===o()){for(var a=-1,c=0;c<n.myAlbumsCache.albums.length;c++)if(n.myAlbumsCache.albums[c].id===e){a=c;break}if(-1!==a){var s=Object.assign({},n.myAlbumsCache.albums[a],{tags:t}),i=Object(I.a)(n.myAlbumsCache.albums);i.splice(a,1,s);var u=n.myAlbumsCache.lastCached;r((function(e){return Object(y.a)(Object(y.a)({},e),{},{myAlbumsCache:{albums:i,lastCached:u}})}))}else console.warn("setTagsForAlbum: could not find cached album!")}return new Promise((function(n,a){te.updateDoc({id:e,tags:t}).then((function(e){e?l().then((function(){return n(!0)})):n(!1)}))}))},getAlbumTracks:function(e,t){return new Promise((function(n,a){te.fetchTracksForAlbum(e,t).then((function(e){n(e)}),(function(e){console.warn("could not get album tracks",e),n([])}))}))},getAllTags:function(){return n.allTags},refreshAllTags:l,getCurrentTags:function(){return n.currentTags},setCurrentTags:b,resetCurrentTags:function(){r((function(e){return Object(y.a)(Object(y.a)({},e),{},{currentTags:Object(I.a)(e.currentTags)})}))},addCurrentTag:h,removeCurrentTag:f,toggleCurrentTag:function(e){-1===n.currentTags.indexOf(e)?h(e):f(e)},getCurrentAlbum:function(){return n.currentAlbum},setCurrentAlbum:function(e){r((function(t){return Object(y.a)(Object(y.a)({},t),{},{currentAlbum:e})}))},getPlayingAlbum:function(){return n.playingAlbum},playAlbum:function(e){n.playingAlbum!==e?r((function(t){return Object(y.a)(Object(y.a)({},t),{},{playingAlbum:e,isPlaying:!0})})):!1===n.isPlaying&&r((function(e){return Object(y.a)(Object(y.a)({},e),{},{isPlaying:!0})}))},stopPlaying:function(){r((function(e){return Object(y.a)(Object(y.a)({},e),{},{isPlaying:!1})}))},isPlaying:n.isPlaying,searchDiscogsForAlbum:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(n,a){te.getDiscogsMatchesForAlbum(e,t).then((function(e){e.length>0?n(e[0]):n(void 0)}),(function(e){a(e)}))}))},createPlaylistForTracks:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise(function(){var r=Object(D.a)(P.a.mark((function r(c,s){var i;return P.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,te.createPlaylist(e,t,a);case 3:return i=r.sent,r.next=6,te.addTracksToPlaylist(i,n);case 6:r.sent,c(i),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),s(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})));return function(e,t){return r.apply(this,arguments)}}())}}},re=["handleTagClick","persistent"],ce=Object(u.a)((function(e){return{root:{"&":{height:"100%",display:"flex",flexDirection:"column"},"& h6":{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px 0 ").concat(e.spacing(2),"px")},"& .MuiBox-root":{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px"),borderBottom:"1px solid ".concat(e.palette.grey[700])},"& .MuiBox-root > .MuiTypography-button":{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px ").concat(e.spacing(1),"px 0")},"& .MuiList-root::-webkit-scrollbar":{width:e.scrollBar.width},"& .MuiList-root::-webkit-scrollbar-track":e.scrollBar.track,"& .MuiList-root::-webkit-scrollbar-thumb":e.scrollBar.thumb,"& .MuiList-root":{flexGrow:1,overflowY:"scroll"}}}})),se=function(e,t){return e.sort((function(e,n){if(-1===e.index&&-1===n.index){if("count"===t){var a=n.count-e.count;return 0===a?-1===e.index?1:-1===n.index?-1:e.index-n.index:a}return e.label<n.label?-1:e.label>n.label?1:0}return-1===e.index?1:-1===n.index||e.index<n.index?-1:1}))},ie=function(e){e.handleTagClick;var t=e.persistent,n=Object(v.a)(e,re),r=ae(),c=r.getAllTags,s=r.getCurrentTags,o=r.getAlbumsForCurrentTags,l=r.toggleCurrentTag,u=r.sideBarWidth,b=Object(a.useState)([]),d=Object(i.a)(b,2),h=d[0],f=d[1],j=Object(a.useState)("label"),g=Object(i.a)(j,2),m=g[0],L=g[1],x=Object(a.useRef)(null),O=function(){var e=Object(D.a)(P.a.mark((function e(){var t,n,a,r,l,u,b,d,h,j,p,g;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!((n=s()).length>0)){e.next=14;break}return a={},e.next=6,o();case 6:for(r=e.sent,l=Object(i.a)(r,2),u=l[0],l[1],u.forEach((function(e){e.tags.find((function(e){return-1!==n.indexOf(e)}))&&e.tags.forEach((function(e){void 0===a[e]&&(a[e]=0),a[e]++}))})),b=0,d=Object.entries(a);b<d.length;b++)h=Object(i.a)(d[b],2),j=h[0],p=h[1],g=n.indexOf(j),t.push({label:j,count:p,index:g});e.next=15;break;case 14:t=c().map((function(e){return Object(y.a)(Object(y.a)({},e),{},{index:-1})}));case 15:f(se(t,m));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){x.current.scrollTop=0}),[s()]),Object(a.useEffect)((function(){O()}),[c(),s(),m]);var k=ce();return Object(w.jsxs)(z.a,Object(y.a)(Object(y.a)({},n),{},{className:k.root,style:{width:"".concat(u(),"px")},children:[!t&&Object(w.jsx)(p.a,{variant:"h6",children:"Tags"}),Object(w.jsxs)(z.a,{children:[Object(w.jsx)(p.a,{variant:"button",children:"Sort"}),Object(w.jsxs)(R.a,{children:[Object(w.jsx)(_.a,{onClick:function(){return L("label")},size:"small",variant:"label"===m?"contained":"outlined",children:"Label"}),Object(w.jsx)(_.a,{onClick:function(){return L("count")},size:"small",variant:"count"===m?"contained":"outlined",children:"Count"})]})]}),Object(w.jsxs)(N.a,{dense:t,ref:x,children:[0===h.length&&Object(w.jsx)(B.a,{children:Object(w.jsx)(F.a,{children:"Add some tags to get started"})}),h.map((function(e,t){return Object(w.jsxs)(B.a,{button:!0,selected:-1!==s().indexOf(e.label),onClick:function(){return l(e.label)},children:[Object(w.jsx)(F.a,{children:e.label}),Object(w.jsx)(E.a,{size:"small",disabled:!0,variant:"outlined",label:e.count})]},t)}))]})]}))},oe=n(55),le=n(12),ue=n(65),be=n(54),de=n(53),he=n(1),fe=n(3),je=[{name:"VirtualTable"}],pe="albumArtColumnType";var ge=function(e){Object(be.a)(n,e);var t=Object(de.a)(n);function n(){return Object(K.a)(this,n),t.apply(this,arguments)}return Object(J.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.width;return Object(w.jsxs)(he.g,{name:"AlbumArtColumn",dependencies:je,children:[Object(w.jsx)(he.f,{name:"tableColumns",computed:function(e){return function(e,t){return[{key:pe,type:pe,width:t}].concat(Object(I.a)(e))}(e.tableColumns,n)}}),Object(w.jsx)(he.k,{name:"tableCell",predicate:function(e){return function(e,t){return e.type===fe.q&&t.type===pe}(e.tableRow,e.tableColumn)},children:Object(w.jsx)(oe.c.Cell,{})}),Object(w.jsx)(he.k,{name:"tableCell",predicate:function(e){return function(e,t){return e.type!==fe.q&&e.type!==fe.u&&t.type===pe}(e.tableRow,e.tableColumn)},children:function(e){return Object(w.jsx)(oe.c.Cell,Object(y.a)(Object(y.a)({},e),{},{row:e.tableRow.row,style:{textOverflow:"clip"},children:e.tableRow.row&&Object(w.jsx)(_.a,{variant:"text",style:{padding:"4px"},onClick:function(){return t(e.tableRow.row.id)},children:Object(w.jsx)("img",{src:e.tableRow.row.albumArt,width:"64",height:"64"})})}))}})]})}}]),n}(r.a.PureComponent);ge.defaultProps={width:96};var me=n(172),Le=n.n(me),xe=[{name:"VirtualTable"}],Oe="searchColumnType";var ye=function(e){Object(be.a)(n,e);var t=Object(de.a)(n);function n(){return Object(K.a)(this,n),t.apply(this,arguments)}return Object(J.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.width;return Object(w.jsxs)(he.g,{name:"SearchColumn",dependencies:xe,children:[Object(w.jsx)(he.f,{name:"tableColumns",computed:function(e){return function(e,t){return[].concat(Object(I.a)(e),[{key:Oe,type:Oe,width:t}])}(e.tableColumns,n)}}),Object(w.jsx)(he.k,{name:"tableCell",predicate:function(e){return function(e,t){return e.type===fe.q&&t.type===Oe}(e.tableRow,e.tableColumn)},children:Object(w.jsx)(oe.c.Cell,{children:" "})}),Object(w.jsx)(he.k,{name:"tableCell",predicate:function(e){return function(e,t){return e.type!==fe.q&&e.type!==fe.u&&t.type===Oe}(e.tableRow,e.tableColumn)},children:function(e){return Object(w.jsx)(oe.c.Cell,Object(y.a)(Object(y.a)({},e),{},{row:e.tableRow.row,style:{textOverflow:"clip"},children:Object(w.jsx)(O.a,{onClick:function(){return t(e.tableRow.row)},size:"small",children:Object(w.jsx)(Le.a,{})})}))}})]})}}]),n}(r.a.PureComponent);ye.defaultProps={width:60};var ve=function(e){var t=e.album;return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(p.a,{variant:"h6",noWrap:!0,style:{fontSize:"1rem",fontWeight:400},children:t.albumName}),Object(w.jsx)(p.a,{variant:"body1",noWrap:!0,style:{fontSize:".85rem",fontWeight:300},children:t.albumArtists})]})},ke=function(e){return e.tags.map((function(e,t){return Object(w.jsx)(E.a,{size:"small",label:e,style:{margin:".125rem .25rem .125rem 0"}},t)}))},we=n(347),Ce=n(173),Te=n.n(Ce),Ae=n(327),Se=n(328),Me=n(329),Pe=n(333),De=n(330),Ne=n(332),Be=n(272),Fe=n(188),ze=n(331),Re=Object(u.a)((function(e){return{dialogRoot:{"&.MuiDialog-root .MuiDialogTitle-root":{backgroundColor:e.palette.primary.main}},results:{"&.MuiList-root .MuiListItemAvatar-root":{marginRight:e.spacing(1)}},genres:{"&.MuiList-root":{paddingTop:e.spacing(0),paddingBottom:e.spacing(0)},"&.MuiList-root .MuiListItem-root":{paddingTop:e.spacing(0),paddingBottom:e.spacing(0)}},add:{marginLeft:"auto"},large:{width:e.spacing(10),height:e.spacing(10)}}})),_e=function(e){var t=e.open,n=e.onClose,c=(e.album,ae()),s=c.getCurrentAlbum,o=c.setTagsForAlbum,l=c.resetCurrentTags,u=Object(a.useState)(!1),b=Object(i.a)(u,2),d=b[0],h=b[1],f=Object(a.useState)([]),j=Object(i.a)(f,2),g=j[0],m=j[1],L=Object(a.useState)([]),x=Object(i.a)(L,2),O=x[0],y=x[1];Object(a.useEffect)((function(){if(t){var e=s();y([]),h(!0),te.getDiscogsMatchesForAlbum(e).then((function(e){m([e[0]]),h(!1)}),(function(e){h(!1)}))}}),[t]);var v=Re();return Object(w.jsxs)(Ae.a,{open:t,onClose:n,fullWidth:!0,maxWidth:"xs",className:v.dialogRoot,children:[Object(w.jsx)(Se.a,{children:"Discogs Result"}),Object(w.jsxs)(Me.a,{children:[Object(w.jsxs)(N.a,{dense:!0,className:v.results,children:[d&&Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsxs)(B.a,{dense:!0,children:[Object(w.jsx)(De.a,{children:Object(w.jsx)(ze.a,{variant:"rect",children:Object(w.jsx)(we.a,{variant:"square",className:v.large})})}),Object(w.jsxs)(F.a,{children:[Object(w.jsx)(ze.a,{variant:"text"}),Object(w.jsx)(ze.a,{variant:"text"})]})]}),Object(w.jsxs)(N.a,{dense:!0,subheader:Object(w.jsx)(Ne.a,{children:"Genres & Styles"}),className:v.genres,children:[Object(w.jsx)(B.a,{dense:!0,children:Object(w.jsx)(F.a,{children:Object(w.jsx)(ze.a,{variant:"text"})})}),Object(w.jsx)(B.a,{dense:!0,children:Object(w.jsx)(F.a,{children:Object(w.jsx)(ze.a,{variant:"text"})})}),Object(w.jsx)(B.a,{dense:!0,children:Object(w.jsx)(F.a,{children:Object(w.jsx)(ze.a,{variant:"text"})})})]})]}),!d&&g.length>0&&g.map((function(e,t){return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsxs)(B.a,{dense:!0,button:!0,onClick:function(){return t=e.uri,void window.open("https://discogs.com".concat(t),"discogsWindow");var t},children:[Object(w.jsx)(De.a,{children:Object(w.jsx)(we.a,{variant:"square",src:e.thumb,className:v.large})}),Object(w.jsx)(F.a,{primary:e.title,secondary:e.artists})]}),Object(w.jsx)(N.a,{dense:!0,subheader:Object(w.jsx)(Ne.a,{children:"Genres & Styles"}),className:v.genres,children:e.genres.map((function(e,t){return Object(w.jsxs)(B.a,{dense:!0,button:!0,onClick:function(){return function(e){var t=O.indexOf(e),n=Object(I.a)(O);-1===t?n.push(e):n.splice(t,1),y(n)}(e)},children:[Object(w.jsx)(Be.a,{children:Object(w.jsx)(Fe.a,{checked:-1!==O.indexOf(e),disableRipple:!0})}),Object(w.jsx)(F.a,{children:e})]},t)}))})]},t)}))]}),!d&&0===g.length&&Object(w.jsx)(z.a,{style:{textAlign:"center",width:"100%",height:"100px"},children:Object(w.jsx)(p.a,{variant:"body1",style:{marginTop:"30px"},children:"No match \ud83d\ude13"})})]}),Object(w.jsx)(Pe.a,{children:Object(w.jsx)(_.a,{startIcon:Object(w.jsx)(Te.a,{}),disabled:d||!d&&(0===g.length||0===O.length),onClick:function(){!function(e){var t=s(),n=Object(I.a)(e);t.tags&&(n=n.concat(t.tags)),n=n.filter((function(e,t,n){return n.indexOf(e)===t}));var a=t.id;o(a,n),l()}(O),n()},children:"Add Tags to Album"})})]})},Ee=Object(u.a)((function(e){return{root:{"&":{height:"100%"},"& table:first-of-type":{backgroundColor:e.palette.primary.dark},"& .MuiTableCell-head":{padding:e.spacing(1)},"& .MuiTable-root .MuiTableBody-root .MuiTableRow-root .MuiTableCell-body":{padding:"2px 4px"},"& > div > div::-webkit-scrollbar":{width:e.scrollBar.width},"& > div > div::-webkit-scrollbar-track":e.scrollBar.track,"& > div > div::-webkit-scrollbar-thumb":e.scrollBar.thumb},chipTag:{marginRight:e.spacing(1)},paginator:{"&.MuiPagination-root .MuiPagination-ul":{justifyContent:"center"}}}})),Ie=[{name:"title",title:"Title",getCellValue:function(e){return e.albumName+" - "+e.albumArtists}},{name:"tags",title:"Tags",getCellValue:function(e){if(e.tags){var t=e.tags;return Array.isArray(t)||(t=String(t).split(/\s*,\s*/).filter((function(e){return String(e).trim().length>0}))),t}return[]}}],We=function(e){var t=e.row;return Object(w.jsx)(ve,{album:t})},Ue=function(e){return Object(w.jsx)(le.b,Object(y.a)({for:["title"],formatterComponent:We},e))},qe=function(e){var t=e.value;return Object(w.jsx)("div",{style:{maxHeight:"84px",overflow:"hidden"},children:Object(w.jsx)(ke,{tags:t})})},Ge=function(e){return Object(w.jsx)(le.b,Object(y.a)({for:["tags"],formatterComponent:qe},e))};var Ke=function(e){return Object(w.jsx)(oe.a.Root,Object(y.a)(Object(y.a)({},e),{},{style:{height:"99%"}}))},Je=function(){var e=ae(),t=e.getAlbumsForCurrentTags,n=e.getCurrentTags,c=e.needsMyAlbumsCache,s=e.setCurrentAlbum,o=e.playAlbum,l=e.sideBarWidth,u=Object(a.useRef)(),b=Object(a.useState)(!1),d=Object(i.a)(b,2),h=d[0],f=d[1],j=Object(a.useState)([]),p=Object(i.a)(j,2),g=p[0],m=p[1],L=Object(a.useState)(),x=Object(i.a)(L,2),O=x[0],y=x[1],v=function(){var e=window.innerWidth>800,t=window.innerWidth-82-40-10;e&&(t-=l());var n=Math.round(t*(t>450?.4:.6));y([{columnName:"title",width:n},{columnName:"tags",width:t-n,wordWrapEnabled:!0}])};Object(a.useEffect)((function(){v(),window.addEventListener("resize",Object(ue.a)(v,250))}),[]),Object(a.useEffect)((function(){Object(D.a)(P.a.mark((function e(){var n,a,r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==c()){e.next=8;break}return e.next=3,t();case 3:n=e.sent,a=Object(i.a)(n,2),r=a[0],a[1],m(r);case 8:case"end":return e.stop()}}),e)})))()}),[c(),n()]),Object(a.useEffect)((function(){u.current.scrollToRow(0)}),[g]);var k=Ee();return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)("div",{className:k.root,children:Object(w.jsxs)(oe.a,{rootComponent:Ke,rows:g,columns:Ie,children:[Object(w.jsx)(le.k,{}),Object(w.jsx)(le.h,{}),Object(w.jsx)(Ue,{}),Object(w.jsx)(Ge,{}),Object(w.jsx)(oe.c,{height:"auto",estimatedRowHeight:78,columnExtensions:O,ref:u}),Object(w.jsx)(oe.b,{showSortingControls:!0}),Object(w.jsx)(ge,{onClick:o,width:82}),Object(w.jsx)(ye,{onClick:function(e){s(e),f(!0)},width:40})]})}),Object(w.jsx)(_e,{open:h,onClose:function(){return f(!1)}})]})};var Ve="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("666253527bbe47a1b7abffd28c9dd851","&redirect_uri=").concat("https://ajmacdonald.github.io/tagger/","&scope=").concat(["streaming","user-read-email","user-read-private","user-read-currently-playing","user-read-playback-state","user-modify-playback-state","user-library-read","user-library-modify","playlist-read-private","playlist-modify-private","playlist-modify-public","playlist-read-collaborative"].join("%20"),"&response_type=token&show_dialog=false"),He=function(e){return Object(w.jsx)(_.a,Object(y.a)(Object(y.a)({},e),{},{onClick:function(){return window.location.href=Ve},children:"Connect to Spotify"}))},Xe=Object(u.a)((function(e){return{box:{borderTop:"2px solid ".concat(e.palette.grey[800])}}})),Ze=function(e){var t=e.width,n=e.height,a=ae(),r=a.getPlayingAlbum,c=(a.playAlbum,a.stopPlaying,Xe());return Object(w.jsxs)(z.a,{children:[r()&&Object(w.jsx)("iframe",{src:"https://open.spotify.com/embed/album/".concat(r()),width:t,height:n,frameBorder:"0",allowtransparency:"true",allow:"encrypted-media"}),!r()&&Object(w.jsx)(z.a,{width:t,height:n,className:c.box,children:Object(w.jsx)("img",{style:{width:"".concat(t/2,"px"),height:"".concat(n/2,"px"),opacity:.5,position:"relative",top:"50%",transform:"translate(50%, -50%)"},src:"/tagger/spotify_icons/Spotify_Icon_RGB_Black.png"})})]})},Ye=n(133),$e=n.n(Ye),Qe=n(178),et=n.n(Qe),tt=n(177),nt=n.n(tt),at=n(176),rt=n.n(at),ct=n(110),st=n.n(ct),it=n(91),ot=n(348),lt=n(274),ut=n(275),bt=n(139),dt=n(336),ht=n(344),ft=n(179),jt=n(174),pt=n.n(jt),gt=n(175),mt=n.n(gt),Lt=Object(u.a)((function(e){return{tagsBar:{backgroundColor:"#58319C",minHeight:"50px"},tagIcon:{color:e.palette.primary.light,marginRight:e.spacing(1)},chipTag:{marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1)}}})),xt=function(e){var t=e.onDelete,n=ae().getCurrentTags,a=Lt();return Object(w.jsxs)(j.a,{className:a.tagsBar,children:[Object(w.jsx)(pt.a,{fontSize:"large",className:a.tagIcon}),Object(w.jsx)(z.a,{children:n().map((function(e,n){return t?Object(w.jsx)(E.a,{label:e,className:a.chipTag,color:"secondary",onClick:function(){return t(e)},onDelete:function(){return t(e)},deleteIcon:Object(w.jsx)(mt.a,{})},n):Object(w.jsx)(E.a,{label:e,className:a.chipTag,color:"secondary"},n)}))})]})},Ot=Object(u.a)((function(e){return{title:{marginLeft:e.spacing(2),flex:1},root:{"& .MuiPaper-root.MuiDialog-paper":{backgroundColor:e.palette.background.default},"& .MuiDialogContent-root":{padding:e.spacing(3)}},controls:{"&":{display:"flex",flexFlow:"column nowrap",justifyContent:"center",alignItems:"center",padding:e.spacing(2)},"& > *":{marginTop:e.spacing(1),marginBottom:e.spacing(1),marginLeft:e.spacing(0)}},summary:{marginBottom:e.spacing(2)},albums:{"&.MuiDataGrid-root .MuiDataGrid-cell:focus, &.MuiDataGrid-root .MuiDataGrid-cell:focus-within":{outline:"none"},"& .custom-header":{},"& .custom-cell":{textAlign:"center"}},chart:{"&.MuiGrid-root":{height:"100%"},"&.MuiGrid-root .MuiGrid-item":{backgroundColor:e.palette.secondary.main,margin:"0 2px 0 0"}}}})),yt=[{field:"id",headerName:"ID",hide:!0,filterable:!1,sortable:!1},{field:"albumArt",headerName:" ",width:90,filterable:!1,sortable:!1,renderCell:function(e){return r.a.createElement("img",{width:"60px",height:"60px",src:e.value})}},{field:"title",headerName:"Title",flex:1,filterable:!1,sortable:!1,headerClassName:"custom-header",renderCell:function(e){return Object(w.jsxs)(z.a,{style:{flexDirection:"column",alignItems:"flex-start",width:"100%"},children:[Object(w.jsx)(p.a,{variant:"h6",noWrap:!0,style:{fontSize:"1rem",fontWeight:400},children:e.row.albumName}),Object(w.jsxs)(z.a,{display:"flex",style:{flexDirection:"row"},children:[Object(w.jsx)(p.a,{variant:"body1",noWrap:!0,style:{fontSize:".85rem",fontWeight:300},children:e.row.albumArtists}),Object(w.jsxs)(p.a,{variant:"body1",style:{display:"none",fontSize:".85rem",fontWeight:100},children:["\xa0\u2022\xa0",e.row.year]})]})]})}},{field:"popularityChart",headerName:"Popularity",width:200,filterable:!1,sortable:!1,headerAlign:"center",headerClassName:"custom-header",renderCell:function(e){return Object(w.jsx)(vt,{tracks:e.row.tracks})}},{field:"tracks",headerName:"Tracks",width:90,filterable:!1,sortable:!1,headerAlign:"center",headerClassName:"custom-header",cellClassName:"custom-cell",valueFormatter:function(e){var t=e.row.tracks.length,n=e.row.tracks.filter((function(e){return e.include}));return"".concat(n.length," / ").concat(t)}}],vt=function(e){var t=e.tracks,n=Ot(),a=2*t.length,r=Math.min(8,(200-a)/t.length);return Object(w.jsx)(L.a,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"flex-end",className:n.chart,children:t.map((function(e,t){return Object(w.jsx)(L.a,{item:!0,style:{height:"".concat(e.popularity,"% "),width:"".concat(r,"px"),opacity:"".concat(e.include?1:.25)}},t)}))})},kt=function(e){var t=e.open,n=e.onClose,r=ae(),c=r.getAlbumsForCurrentTags,s=r.getAlbumTracks,o=r.createPlaylistForTracks,l=Object(a.useState)(!1),u=Object(i.a)(l,2),b=u[0],d=u[1],h=Object(a.useState)(!1),g=Object(i.a)(h,2),m=g[0],x=g[1],y=Object(a.useState)([]),v=Object(i.a)(y,2),k=v[0],C=v[1],T=Object(a.useState)(0),A=Object(i.a)(T,2),S=A[0],M=A[1],N=Object(a.useState)(0),B=Object(i.a)(N,2),F=B[0],R=B[1],E=Object(a.useState)(0),W=Object(i.a)(E,2),U=W[0],q=W[1],G=Object(a.useState)(!1),K=Object(i.a)(G,2),J=K[0],V=K[1],H=Object(a.useState)(""),X=Object(i.a)(H,2),Z=X[0],Y=X[1],$=Object(a.useState)(""),Q=Object(i.a)($,2),ee=Q[0],te=Q[1],ne=Object(a.useState)(!1),re=Object(i.a)(ne,2),ce=re[0],se=re[1],ie=Object(a.useState)(!1),oe=Object(i.a)(ie,2),le=oe[0],ue=oe[1],be=Object(a.useState)(void 0),de=Object(i.a)(be,2),he=de[0],fe=de[1],je=function(){var e=Object(D.a)(P.a.mark((function e(){var t,n,a,r,o,l,u,b;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:t=e.sent,n=Object(i.a)(t,2),a=n[0],r=n[1],o=0,l=0;case 8:if(!(l<a.length)){e.next=22;break}return u=a[l],e.next=12,s(u.id,!0);case 12:b=e.sent,u.tracks=b.map((function(e){return{uri:e.uri,popularity:e.popularity,include:!0}})),o+=u.tracks.length,u.averagePopularity=Math.round(pe(u)),u.maxPopularity=ge(u),u.minPopularity=me(u),u.popularityRange=Math.max(1,u.maxPopularity-u.minPopularity);case 19:l++,e.next=8;break;case 22:C(a),M(r),R(o);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(e){return e.tracks.map((function(e){return e.popularity})).reduce((function(e,t){return e+t}))/e.tracks.length},ge=function(e){return e.tracks.map((function(e){return e.popularity})).reduce((function(e,t){return t>e?t:e}),0)},me=function(e){return e.tracks.map((function(e){return e.popularity})).reduce((function(e,t){return t<e?t:e}),200)};Object(a.useEffect)((function(){var e=Object(I.a)(k),t=0;e.forEach((function(e){!function(e,t){var n=U/100,a=Math.abs(1-n);e.tracks.forEach((function(r){if(0===e.maxPopularity)r.include=J;else if("avg"===t){var c=r.popularity/e.maxPopularity;r.include=c>=n}else if("range"===t){var s=e.maxPopularity-r.popularity;r.include=s/e.popularityRange<=a}}))}(e,"range"),t+=e.tracks.filter((function(e){return e.include})).length})),C(e),R(t)}),[U,J]),Object(a.useEffect)((function(){t?Object(D.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,je();case 3:d(!1);case 4:case"end":return e.stop()}}),e)})))():setTimeout((function(){C([]),M(0),q(0),Y(""),te(""),se(!1),ue(!1),fe(void 0)}),100)}),[t]);var Le=Ot();return Object(w.jsxs)(Ae.a,{open:t,onClose:n,fullScreen:!0,className:Le.root,children:[Object(w.jsxs)(f.a,{position:"relative",children:[Object(w.jsxs)(j.a,{children:[Object(w.jsx)(O.a,{edge:"start",color:"inherit",onClick:n,"aria-label":"close",children:Object(w.jsx)(st.a,{})}),Object(w.jsx)(p.a,{variant:"h6",className:Le.title,children:"Playlist Creator"})]}),Object(w.jsx)(xt,{})]}),Object(w.jsx)(Me.a,{children:Object(w.jsxs)(L.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"flex-start",spacing:3,children:[Object(w.jsx)(L.a,{item:!0,xs:12,sm:12,md:4,lg:3,children:Object(w.jsxs)(it.a,{className:Le.controls,children:[Object(w.jsxs)("div",{id:"popularity-slider",style:{width:"100%"},children:[Object(w.jsx)(p.a,{gutterBottom:!0,children:"Popularity Threshold"}),Object(w.jsxs)(L.a,{container:!0,spacing:2,children:[Object(w.jsx)(L.a,{item:!0,children:Object(w.jsx)(rt.a,{})}),Object(w.jsx)(L.a,{item:!0,xs:!0,children:Object(w.jsx)(ot.a,{value:U,onChange:function(e,t){return q(t)},color:"secondary"})}),Object(w.jsx)(L.a,{item:!0,children:Object(w.jsx)(nt.a,{})})]})]}),Object(w.jsx)(lt.a,{label:"Include Albums With No Popularity Info",labelPlacement:"start",control:Object(w.jsx)(ut.a,{checked:J,onChange:function(e){return V(e.target.checked)},size:"small",color:"secondary"})}),Object(w.jsx)(bt.a,{variant:"outlined",color:"secondary",fullWidth:!0,spellCheck:!1,error:le,label:"Playlist Title",value:Z,onChange:function(e){Y(e.target.value),ue(!1)}}),Object(w.jsx)(bt.a,{variant:"outlined",color:"secondary",fullWidth:!0,multiline:!0,minRows:2,maxRows:2,spellCheck:!1,label:"Playlist Description",value:ee,onChange:function(e){return te(e.target.value)}}),Object(w.jsx)(lt.a,{label:"Public Playlist",labelPlacement:"start",control:Object(w.jsx)(ut.a,{checked:ce,onChange:function(e){return se(e.target.checked)},color:"secondary"})}),Object(w.jsxs)(p.a,{className:Le.summary,children:[b&&"Fetching Track Info...",!b&&"Total Tracks: ".concat(F)]}),Object(w.jsx)(_.a,{variant:"contained",color:"secondary",size:"large",disabled:b,endIcon:m?Object(w.jsx)(et.a,{}):Object(w.jsx)($e.a,{}),onClick:function(){0===Z.length?ue(!0):Object(D.a)(P.a.mark((function e(){var t,n,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),t=Object(I.a)(k),n=[],t.map((function(e){return e.tracks.forEach((function(e){e.include&&n.push(e.uri)}))})),e.prev=4,e.next=7,o(Z,ee,n,ce);case 7:a=e.sent,fe(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.warn(e.t0);case 14:x(!1);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})))()},children:"Create Spotify Playlist"}),he&&Object(w.jsx)(z.a,{style:{textAlign:"center",marginTop:"16px"},children:Object(w.jsxs)(p.a,{variant:"h6",children:["Playlist ",Object(w.jsx)(dt.a,{href:"https://open.spotify.com/playlist/".concat(he),target:"_blank",rel:"noreferrer",color:"secondary",children:Z})," created!"]})})]})}),Object(w.jsx)(ht.a,{smDown:!0,children:Object(w.jsx)(L.a,{item:!0,sm:8,md:8,lg:9,style:{display:"flex",height:"calc(100vh - 170px)"},children:Object(w.jsx)("div",{style:{flexGrow:1},children:Object(w.jsx)(ft.a,{className:Le.albums,loading:b,componentsProps:{popularityThreshold:U},rows:k,columns:yt,rowCount:S,pageSize:S,rowHeight:60,hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0})})})})]})})]})},wt=function(e){var t=ae().getCurrentTags,n=Object(a.useState)(!1),c=Object(i.a)(n,2),s=c[0],o=c[1];return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(g.a,{title:"Create Playlist from Tags",children:Object(w.jsx)("span",{children:Object(w.jsx)(O.a,{onClick:function(){s||o(!0)},disabled:0===t().length,children:Object(w.jsx)($e.a,{})})})}),Object(w.jsx)(kt,{open:s,onClose:function(){return o(!1)}})]})},Ct=n(180),Tt=n(82),At=n(338),St=n(181),Mt=n.n(St),Pt=n(8),Dt=function(e){Object(be.a)(n,e);var t=Object(de.a)(n);function n(e){var a;return Object(K.a)(this,n),(a=t.call(this,e)).batchSize=1,a.state={working:!1,complete:!1,progress:0,offset:0-a.batchSize,total:-1,onlyUntagged:!0,overwriteTags:!1,currentAlbum:void 0,tagged:[],unmatched:[],skipped:[]},a.toggleWorking=a.toggleWorking.bind(Object(Tt.a)(a)),a.toggleUntagged=a.toggleUntagged.bind(Object(Tt.a)(a)),a.toggleOverwrite=a.toggleOverwrite.bind(Object(Tt.a)(a)),a.handleClose=a.handleClose.bind(Object(Tt.a)(a)),a}return Object(J.a)(n,[{key:"processBatch",value:function(){var e=Object(D.a)(P.a.mark((function e(t){var n,a,r,c,s,o,l,u,b,d,h,f,j,p=this;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.getMyAlbums(t,this.batchSize);case 3:r=e.sent,c=Object(i.a)(r,2),n=c[0],a=c[1],e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),new Error(e.t0);case 12:s=Object(I.a)(this.state.tagged),o=Object(I.a)(this.state.unmatched),l=Object(I.a)(this.state.skipped),u=0;case 16:if(!(u<n.length)){e.next=49;break}if(b=n[u],d=!1,(!this.state.onlyUntagged||0!==b.tags.length)&&this.state.onlyUntagged){e.next=43;break}return h=void 0,e.prev=21,e.next=24,this.props.searchDiscogsForAlbum(b,!0);case 24:h=e.sent,e.next=30;break;case 27:throw e.prev=27,e.t1=e.catch(21),new Error(e.t1);case 30:if(!h){e.next=40;break}return f=h.genres,!1===this.state.overwriteTags&&b.tags.length>0&&(b.tags.concat(f),Object(Ct.a)("tags")),b.tags=f,e.next=36,this.props.setTagsForAlbum(b.id,f);case 36:e.sent&&s.push(b),e.next=41;break;case 40:o.push(b);case 41:e.next=45;break;case 43:d=!0,l.push(b);case 45:this.setState({currentAlbum:d?void 0:b,tagged:s,unmatched:o,skipped:l},(function(){return p.forceUpdate()}));case 46:u++,e.next=16;break;case 49:this.setState({tagged:s,unmatched:o,skipped:l}),(j=Math.min(a,t+this.batchSize))>=a?(this.setState({progress:100,working:!1,currentAlbum:void 0,complete:!0}),this.props.resetCurrentTags()):this.state.working&&this.setState({offset:j,total:a});case 53:case"end":return e.stop()}}),e,this,[[0,9],[21,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"toggleWorking",value:function(){var e=this;this.state.working?this.stopWorking():this.setState({working:!0,offset:this.state.offset+this.batchSize},(function(){return e.forceUpdate()}))}},{key:"stopWorking",value:function(){this.state.working&&(this.setState({working:!1,offset:this.state.offset-this.batchSize,currentAlbum:void 0}),this.props.resetCurrentTags())}},{key:"toggleUntagged",value:function(){this.setState({onlyUntagged:!this.state.onlyUntagged})}},{key:"toggleOverwrite",value:function(){this.setState({overwriteTags:!this.state.overwriteTags})}},{key:"handleClose",value:function(){this.stopWorking(),this.props.onClose()}},{key:"normalize",value:function(e,t,n){return 100*(e-t)/(n-t)}},{key:"componentDidMount",value:function(){var e=this;this.props.getMyAlbums(0,1).then((function(t){var n=Object(i.a)(t,2),a=(n[0],n[1]);e.setState({total:a})}))}},{key:"componentDidUpdate",value:function(e,t,n){if(this.state.working&&t.offset!==this.state.offset){var a=Math.round(this.normalize(this.state.offset,0,this.state.total));this.setState({progress:a}),this.state.offset<this.state.total&&this.processBatch(this.state.offset)}else this.state.complete}},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(w.jsxs)(Ae.a,{open:this.props.open,onClose:this.handleClose,fullScreen:!0,className:t.root,children:[Object(w.jsx)(f.a,{position:"relative",children:Object(w.jsxs)(j.a,{children:[Object(w.jsx)(O.a,{edge:"start",color:"inherit",onClick:this.handleClose,"aria-label":"close",children:Object(w.jsx)(st.a,{})}),Object(w.jsx)(p.a,{variant:"h6",className:t.title,children:"Auto Tagger"})]})}),Object(w.jsx)(Me.a,{children:Object(w.jsxs)(L.a,{container:!0,direction:"row",justifyContent:"center",alignItems:"flex-start",spacing:3,children:[Object(w.jsx)(L.a,{item:!0,xs:12,md:4,lg:3,children:Object(w.jsxs)(it.a,{className:t.controls,children:[Object(w.jsx)(lt.a,{label:"Only Untagged Albums",labelPlacement:"start",control:Object(w.jsx)(ut.a,{checked:this.state.onlyUntagged,onChange:function(t){return e.toggleUntagged(t.target.checked)},size:"small",color:"secondary"})}),Object(w.jsx)(lt.a,{label:"Overwrite Existing Tags",labelPlacement:"start",control:Object(w.jsx)(ut.a,{checked:this.state.overwriteTags,onChange:function(t){return e.toggleOverwrite(t.target.checked)},size:"small",color:"secondary"})}),Object(w.jsx)(_.a,{variant:"contained",color:"secondary",size:"large",endIcon:this.state.working?Object(w.jsx)(Mt.a,{}):Object(w.jsx)(S.a,{}),onClick:this.toggleWorking,children:this.state.working?"Stop Tagging":"Start Tagging"})]})}),Object(w.jsxs)(L.a,{item:!0,xs:12,md:8,lg:9,children:[Object(w.jsx)(p.a,{variant:"h6",children:"Stats"}),Object(w.jsxs)(p.a,{variant:"subtitle1",children:["Tagged: ",this.state.tagged.length]}),Object(w.jsxs)(p.a,{variant:"subtitle1",children:["Unmatched: ",this.state.unmatched.length]}),Object(w.jsxs)(p.a,{variant:"subtitle1",children:["Skipped: ",this.state.skipped.length]}),Object(w.jsx)(At.a,{className:t.progressBar,variant:"determinate",color:"secondary",value:this.state.progress}),this.state.working&&this.state.currentAlbum&&Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(ve,{album:this.state.currentAlbum}),Object(w.jsx)(ke,{tags:this.state.currentAlbum.tags})]}),this.state.complete&&this.state.unmatched.length>0&&Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(p.a,{variant:"h6",children:"Unmatched Albums:"}),Object(w.jsx)(z.a,{className:t.unmatchedList,children:this.state.unmatched.map((function(e,t){return Object(w.jsx)(ve,{album:e},t)}))})]})]})]})})]})}}]),n}(r.a.Component),Nt=Object(Pt.a)((function(e){return{title:{marginLeft:e.spacing(2),flex:1},root:{"& .MuiPaper-root.MuiDialog-paper":{backgroundColor:e.palette.background.default},"& .MuiDialogContent-root":{padding:e.spacing(3)}},controls:{"&":{display:"flex",flexFlow:"column nowrap",justifyContent:"center",alignItems:"center",padding:e.spacing(2)},"& > *":{marginTop:e.spacing(1),marginBottom:e.spacing(1),marginLeft:e.spacing(0)}},progressBar:{marginTop:e.spacing(3),marginBottom:e.spacing(3)},unmatchedList:{"& h6":{marginTop:e.spacing(1)}}}}),{withTheme:!0})(Dt),Bt=n(273),Ft=n(277),zt=function(e){Object(be.a)(n,e);var t=Object(de.a)(n);function n(e){var a;return Object(K.a)(this,n),(a=t.call(this,e)).state={working:!1,progress:0,offset:-1,total:-1,cachedAlbums:[]},a.batchSize=20,a}return Object(J.a)(n,[{key:"processBatch",value:function(){var e=Object(D.a)(P.a.mark((function e(t){var n,a,r,c,s,o,l=this;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.getMyAlbums(t,this.batchSize);case 3:r=e.sent,c=Object(i.a)(r,2),n=c[0],a=c[1],e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),new Error(e.t0);case 12:s=Object(I.a)(this.state.cachedAlbums).concat(n),(o=Math.min(a,t+this.batchSize))>=a?this.setState({progress:100,working:!1},(function(){l.forceUpdate(),setTimeout((function(){l.props.setMyAlbumsCache(s)}),50)})):this.setState({cachedAlbums:s,offset:o,total:a});case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"normalize",value:function(e,t,n){return 100*(e-t)/(n-t)}},{key:"componentDidMount",value:function(){var e=this.props.getMyAlbumsCache();if(null===e)this.setState({offset:0,total:1,working:!0});else{var t=Object(I.a)(e);this.props.setMyAlbumsCache(t)}}},{key:"componentDidUpdate",value:function(e,t,n){if(this.state.working&&t.offset!==this.state.offset){var a=Math.round(this.normalize(this.state.offset,0,this.state.total));this.setState({progress:a}),this.state.offset<this.state.total&&this.processBatch(this.state.offset)}}},{key:"render",value:function(){return Object(w.jsx)(Bt.a,{className:this.props.classes.backdrop,open:this.state.working,children:Object(w.jsxs)(L.a,{container:!0,direction:"column",justifyContent:"center",alignItems:"center",spacing:3,children:[Object(w.jsx)(L.a,{item:!0,children:Object(w.jsx)(p.a,{children:"Loading Albums..."})}),Object(w.jsx)(L.a,{item:!0,children:Object(w.jsx)(Rt,{size:65,value:this.state.progress})})]})})}}]),n}(r.a.Component),Rt=function(e){return Object(w.jsxs)(z.a,{position:"relative",display:"inline-flex",children:[Object(w.jsx)(Ft.a,Object(y.a)({variant:"determinate"},e)),Object(w.jsx)(z.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(w.jsx)(p.a,{variant:"caption",component:"div",color:"textSecondary",children:"".concat(e.value,"%")})})]})},_t=Object(Pt.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:e.palette.grey}}}),{withTheme:!0})(zt),Et=250,It=Object(l.b)({palette:{type:"dark",primary:{main:d.a[500]},secondary:{main:h.a.A400}}});It.scrollBar={width:8,track:{backgroundColor:"".concat(It.palette.background.default)},thumb:{backgroundColor:"".concat(It.palette.grey[600])}};var Wt=Object(u.a)((function(e){return{root:{display:"flex",flexFlow:"column nowrap",height:"100vh"},title:{flexGrow:1},main:{flex:"1 1 auto",display:"flex",flexFlow:"row nowrap",overflow:"hidden"},sideBar:{borderRight:"2px solid ".concat(e.palette.grey[800])},content:{flex:"1 1 auto"}}})),Ut=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var n=t.split("=");e[n[0]]=decodeURIComponent(n[1])}return e}),{});window.location.hash="";function qt(){var e=ae(),t=e.setSpotifyToken,n=e.setDatabaseName,c=e.hasSpotifyToken,s=e.persistentSideBar,l=e.sideBarWidth,u=e.getMyAlbums,d=e.searchDiscogsForAlbum,h=e.setTagsForAlbum,y=(e.getCurrentTags,e.removeCurrentTag),v=e.resetCurrentTags,k=e.getMyAlbumsCache,C=e.setMyAlbumsCache,A=e.needsMyAlbumsCache,M=e.isPlaying,P=e.stopPlaying,D=Object(a.useState)(!1),N=Object(i.a)(D,2),B=N[0],F=N[1],z=Object(a.useState)(!1),R=Object(i.a)(z,2),_=R[0],E=R[1],I=function(){F(!B)},W=Wt(It);return Object(a.useEffect)((function(){t(Ut.access_token),n("albumTags")}),[]),Object(w.jsxs)(b.a,{theme:It,children:[Object(w.jsx)(o.a,{}),Object(w.jsxs)("div",{className:W.root,children:[Object(w.jsxs)(f.a,{position:"static",children:[Object(w.jsxs)(j.a,{children:[Object(w.jsx)(O.a,{edge:"start",disabled:!c()||s(),onClick:I,children:Object(w.jsx)(T,{fontSize:"large"})}),Object(w.jsx)(p.a,{variant:"h6",className:W.title,children:"Tagger for Spotify"}),Object(w.jsx)(g.a,{title:"Auto Tag Albums",children:Object(w.jsx)("span",{children:Object(w.jsx)(O.a,{onClick:function(){return E(!0)},disabled:!1===c(),children:Object(w.jsx)(S.a,{})})})}),Object(w.jsx)(wt,{})]}),Object(w.jsx)(xt,{onDelete:y})]}),Object(w.jsxs)("main",{className:W.main,children:[!c()&&Object(w.jsx)(m.a,{style:{marginTop:"100px",textAlign:"center"},children:Object(w.jsx)(He,{variant:"contained",color:"secondary"})}),c()&&Object(w.jsxs)(r.a.Fragment,{children:[s()&&Object(w.jsxs)(L.a,{container:!0,direction:"column",justifyContent:"flex-start",alignItems:"stretch",className:W.sideBar,style:{flex:"0 0 ".concat(l()+2,"px")},children:[Object(w.jsx)(L.a,{item:!0,style:{height:"calc(100% - ".concat(Et,"px)")},children:Object(w.jsx)(ie,{persistent:!0})}),Object(w.jsx)(L.a,{item:!0,style:{height:"".concat(Et,"px")},children:Object(w.jsx)(Ze,{albumId:"0oGzSazidykcL5XNTEuS9z",width:l(),height:Et})})]}),!s()&&Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(x.a,{variant:"temporary",open:B,onClose:I,ModalProps:{keepMounted:!0},children:Object(w.jsx)(ie,{persistent:!1})}),Object(w.jsx)(x.a,{variant:"temporary",anchor:"bottom",open:M,onClose:P,ModalProps:{keepMounted:!0},children:Object(w.jsx)(Ze,{albumId:"0oGzSazidykcL5XNTEuS9z",width:"100%",height:Et})})]}),Object(w.jsx)("div",{className:W.content,children:Object(w.jsx)(Je,{})}),A()&&Object(w.jsx)(_t,{getMyAlbums:u,getMyAlbumsCache:k,setMyAlbumsCache:C}),Object(w.jsx)(Nt,{open:_,onClose:function(){return E(!1)},getMyAlbums:u,searchDiscogsForAlbum:d,setTagsForAlbum:h,resetCurrentTags:v})]})]})]})]})}s.a.render(Object(w.jsx)(q,{children:Object(w.jsx)(qt,{})}),document.getElementById("root"))}},[[265,1,2]]]);